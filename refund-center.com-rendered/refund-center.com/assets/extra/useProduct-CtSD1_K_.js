import{B as e,b as a,r as t,U as u,A as n,u as r,aq as o,a9 as l}from"./hych-chaoxisima-Csfb3BWR.js";import{d as s,s as i,p as c,u as d,a as v,g as m,b as p}from"./hych-chaoxisima-B8i5Jx_X.js";function f(){const r=s(),o=e(),l=a((()=>r.lang)),d=a((()=>r.slide_list)),v=t(0);u((()=>{setInterval((()=>{v.value=(v.value+1)%d.value.length}),5e3)}));const m=t([]);return n([()=>l.value,()=>o.query.cate_id],(()=>{!async function(){const e=i(),a=await c.getProducts({page:1,limit:999,cate_id:o.query.cate_id||""});m.value=a.data,e.close()}()}),{immediate:!0}),{products:m,banners:d,currentBanner:v,goToBanner:function(e){v.value=e},scrollToProducts:function(){const e=document.getElementById("products-section");e&&e.scrollIntoView({behavior:"smooth",block:"start"})}}}function g(){const u=e(),o=r(),l=s(),m=a((()=>l.lang)),{theme:p}=d(),f=v(),g=a((()=>f.mockLogin)),y=t(null);n([()=>u.params.id,()=>m.value],(()=>{!async function(){const e=i(),a=await c.getProductDetail(u.params.id);y.value=a.data,e.close()}()}),{immediate:!0});const h=t(0),$=a((()=>{var e;return(null==(e=y.value)?void 0:e.images)||[]}));return{product:y,currentImageIndex:h,productImages:$,goToAddress:function(){var e;4!==p.value||g.value?o.push(`/product/${null==(e=y.value)?void 0:e.id}/address`):o.push("/login")},goToAddressWithPayOnDelivery:function(){var e;4!==p.value||g.value?o.push({path:`/product/${null==(e=y.value)?void 0:e.id}/address`,query:{payOnDelivery:"true"}}):o.push("/login")},formatPrice:function(e){return`$${e.toFixed(2)}`},setCurrentImage:function(e){h.value=e},nextImage:function(){h.value=(h.value+1)%$.value.length},prevImage:function(){h.value=0===h.value?$.value.length-1:h.value-1}}}function y(){const r=e(),{freight_money:s}=d(),{isLogin:i}=m(),{product:c}=g(),v=t({firstName:"",lastName:"",country:"",state:"",city:"",zipCode:"",address:"",phone:"",email:"",remark:""}),f=t(3600),y=t(!1),h=t(null),$=a((()=>"true"===r.query.payOnDelivery));function b(){try{const e=localStorage.getItem("user_address_info");if(e){const a=JSON.parse(e);v.value={...v.value,...a}}}catch(e){}}const I=a((()=>{var e;return $.value?0:(null==(e=c.value)?void 0:e.price)||0})),_=a((()=>$.value?Number(s.value):0)),x=a((()=>Number(I.value)+Number(_.value)));function P(){h.value=setInterval((()=>{f.value--,f.value<=0&&(y.value=!0,clearInterval(h.value),h.value=null)}),1e3)}function w(){h.value&&(clearInterval(h.value),h.value=null)}const N=o((()=>async function(){var e;await p.postSubmitOrder({product_id:null==(e=c.value)?void 0:e.id,delivery_name:`${v.value.firstName} ${v.value.lastName}`,delivery_phone:v.value.phone,delivery_email:v.value.email,delivery_address:`${v.value.country} ${v.value.state} ${v.value.city} ${v.value.address} `,remark:v.value.remark,pay_type:$.value?"2":"1"})}()),1e3);return u((()=>{b(),P(),n((()=>i.value),(()=>{i.value&&N()}),{immediate:!0})})),l((()=>{w()})),{product:c,address:v,countdown:f,isExpired:y,subtotal:I,shipping:_,total:x,isPayOnDelivery:$,loadAddressFromStorage:b,formatPrice:function(e){return`$${e.toFixed(2)}`},formatCountdown:function(e){const a=Math.floor(e/3600),t=Math.floor(e%3600/60),u=e%60,n=e=>e.toString().padStart(2,"0");return`${n(a)}:${n(t)}:${n(u)}`},startCountdown:P,stopCountdown:w,debounceSubmitOrder:N}}function h(){const e=r();return{formatPrice:function(e){return`$${e.toFixed(2)}`},goToProduct:function(a){e.push(`/product/${a}`)},handleIntroduction:function(e){return e.replace(/<br\s*\/?>/g,"\n")}}}export{f as a,g as b,y as c,h as u};
